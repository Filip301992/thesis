@(faculty:String)(showBoth:String)
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TimeTable</title>

    <link rel="stylesheet" media="screen" href="/stylesheets/bootstrap.css">

    <!-- Required for full calendar -->
    <link rel="stylesheet" media="screen" href="/stylesheets/fullcalendar.css">
    <script src="@routes.Assets.versioned("javascripts/jquery-min.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascripts/moment.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascripts/fullcalendar.js")" type="text/javascript"></script>

</head>
<body class="container">

<div id='calendar'></div>



<script>
        @*console.log('Start testing for cID: ', @faculty);*@
$(document).ready(function() {

            var items = [];
            var items1 = [];
            var performance = window.performance;
            var date = new Date()
            var start = date.getTime();



    var url = 'http://search.usi.ch/api/courses/35257239/schedules?callback=?';


@*var url = 'http://search.usi.ch/api/courses/'+@cID+'/schedules?callback=?';*@


var t4 = performance.now();
// if empty just show full callendar
@if((faculty.equals("Economics") || faculty.equals("Informatics")) && showBoth.equals("true")){
    // not quite sure if this is good practice
        url = 'http://search.usi.ch/api/courses/35259012/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258068/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259030/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259036/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259041/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258810/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259044/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259037/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259038/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259039/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258041/schedules?callback=?';
        populate(url)



        populate(url)
        url = 'http://search.usi.ch/api/courses/35259074/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259261/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259067/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258060/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258061/schedules?callback=?';
        populate(url)


        populate(url)
        url = 'http://search.usi.ch/api/courses/35258062/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258063/schedules?callback=?';
        populate(url)


    //setTimeout(show, 9000)

        url = 'http://search.usi.ch/api/courses/35259368/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259359/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259367/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259361/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259362/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259358/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259377/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259364/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259379/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259376/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35259374/schedules?callback=?';
        populate1(url)



        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257163/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257165/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257191/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257199/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257211/schedules?callback=?';
        populate1(url)


        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257214/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257221/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257228/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257232/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257235/schedules?callback=?';
        populate1(url)
        url = 'http://search.usi.ch/api/courses/35257243/schedules?callback=?';
        populate1(url)

        setTimeout(show, 18000)
        setTimeout(function(){
            //console.info("Time spent for getting all results for Economics and Informatics is 18sec");
        },18000);


}else if(faculty.equals("Informatics") && showBoth.equals("false")){


        url = 'http://search.usi.ch/api/courses/35259368/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259359/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259367/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259361/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259362/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259358/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259377/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259364/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259379/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259376/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259374/schedules?callback=?';
        populate(url)



        populate(url)
        url = 'http://search.usi.ch/api/courses/35257163/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35257165/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35257191/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35257199/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35257211/schedules?callback=?';
        populate(url)


        populate(url)
        url = 'http://search.usi.ch/api/courses/35257214/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35257221/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35257228/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35257232/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35257235/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35257243/schedules?callback=?';
        populate(url)

        setTimeout(show, 9000)
        setTimeout(function(){

            console.info("Time spent for getting all results for Informatics is 9sec");
        },9000);

 } else if(faculty.equals("Economics") && showBoth.equals("false")){
        url = 'http://search.usi.ch/api/courses/35259012/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258068/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259030/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259036/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259041/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258810/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259044/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259037/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259038/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259039/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258041/schedules?callback=?';
        populate(url)



        populate(url)
        url = 'http://search.usi.ch/api/courses/35259074/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259261/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35259067/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258060/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258061/schedules?callback=?';
        populate(url)


        populate(url)
        url = 'http://search.usi.ch/api/courses/35258062/schedules?callback=?';
        populate(url)
        url = 'http://search.usi.ch/api/courses/35258063/schedules?callback=?';
        populate(url)


        setTimeout(show, 9000)
        setTimeout(function(){
        var t5 = performance.now();
            console.log("Total time: " + (t5 - t4) + " milliseconds.")
            //console.info("Time spent for getting all results for Economics is 9sec");
        },9000);
    } else {
        setTimeout(show, 9000)
        setTimeout(function(){
            //console.warn("Time spent for getting data results from API is 4sec")
        },9000);
    }

var t2 = performance.now();
 function populate (url) {
     $.getJSON(url, function(data) {

         console.log('Entered getJson function');

         var totalResults = 0;

         $.each(data, function(index, element) {

             if (index == 'meta'){
                 totalResults = element.count;
                 console.log('Total number of elements found ' + totalResults);
             }
         });

         $.each(data, function(index, element) {

             if (index == 'data'){
                 if (totalResults != 0){
                     for (i = 0; i < totalResults; i++) {
                         var currentElement = element[i];
                         console.log('Process data for element: ' + i);
                         console.log('start = ' + currentElement.start);
                         console.log('end = ' + currentElement.end);
//                         var classNumber = i + 1;
//                         var newTitle = 'Class' + classNumber;
                         var toAdd = {
                             title:currentElement.course.name_en,
                             start:currentElement.start,
                             end:currentElement.end
                         };
                         var t3 = performance.now();
                         //console.log("Total time " + (t3 - t2) + " milliseconds.")
                         //console.log('Adding item ' + toAdd);
                         items.push(toAdd);
                     }
                 }
             }
         });

     });

 }

    function populate1 (url) {
        $.getJSON(url, function(data) {

            console.log('Entered getJson function');

            var totalResults = 0;

            $.each(data, function(index, element) {

                if (index == 'meta'){
                    totalResults = element.count;
                    console.log('Total number of elements found ' + totalResults);
                }
            });

            $.each(data, function(index, element) {

                if (index == 'data'){
                    if (totalResults != 0){
                        for (i = 0; i < totalResults; i++) {
                            var currentElement = element[i];
                            console.log('Process data for element: ' + i);
                            console.log('start = ' + currentElement.start);
                            console.log('end = ' + currentElement.end);
//                         var classNumber = i + 1;
//                         var newTitle = 'Class' + classNumber;
                            var toAdd = {
                                title:currentElement.course.name_en,
                                start:currentElement.start,
                                end:currentElement.end
                            };

                            console.log('Adding item ' + toAdd);
                            items1.push(toAdd);
                        }
                    }
                }
            });

        });

    }
var t0 = performance.now();
 function show () {
        $('#calendar').fullCalendar({
            eventSources: [
                {
                    events: items,
                    color: 'yellow',
                    textColor: 'black'
                },
                {
                    events: items1,
                    color: 'blue',
                    textColor: 'white'
                }
            ]
        })
        var t1 = performance.now();
        console.log("API time: " + (t1 - t0) + " milliseconds.")
     //var div = document.getElementById("loadDiv");
       // div.style.display = "none"

    }


});


</script>
    <div style="display: flex;
        justify-content: center" ;
    >
        <input type="button" class="btn btn-info " onclick="location.href = 'http://localhost:9000/timetableRead?faculty=Economics';" value="Economics"  style="margin: 10px;"/>
        <input type="button" class="btn btn-info " onclick="location.href = 'http://localhost:9000/timetableRead?faculty=Informatics';" value="Informatics"style="margin: 10px;" />

    </div>
</body>
</html>